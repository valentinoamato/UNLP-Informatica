;d) * Escribir un programa que solicite ingresar caracteres por teclado y que recién al presionar la tecla F10
;los envíe a la impresora a través de la PIO. No es necesario mostrar los caracteres en la pantalla
EOI EQU 20H
IMR EQU 21H
INT0 EQU 24H
ID_INT0 EQU 10
PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H

ORG 40
DW RUT_F10

ORG 1000H
STR DB "Ingrese un numero:"
FIN DB ?
F10 DB 0

ORG 1500H
STR2 DB ?

ORG 2000H
;CONFIGURACION PIC
CLI
MOV AL,11111110B
OUT IMR,AL

MOV AL,ID_INT0
OUT INT0,AL
STI
;CONFIGURACION DE PA 
MOV AL,1
OUT CA,AL
;CONFIGURACION DE PB 
MOV AL, 0
OUT CB, AL
;CANTIDAD DE CARACTERES INGRESADOS
MOV CX,0
;MAIN LOOP
INPUT:
;INGRESE NUMERO
MOV BX, OFFSET STR
MOV AL, OFFSET FIN-OFFSET STR
INT 7
;INGRESO DE NUMERO
MOV BX,OFFSET STR2
ADD BX,CX
INT 6
;AUMENTO CX
INC CX
;SI NO SE APRETO F10 INGRESO MAS NUMEROS SINO IMPRIMO
CMP F10,1
JNZ INPUT

;IMPRESION
MOV BX,OFFSET STR2
PRINT:
;CONSULTA DE ESTADO
IN AL,PA
AND AL,1
JNZ PRINT
;IMPRIMO CARACTER
MOV AL,[BX]
OUT PB,AL
CALL SEND_STROBE
;AUMENTO BX REDUZCO CX
INC BX
DEC CX
JNZ PRINT
HLT

ORG 3000H
SEND_STROBE:
PUSH AX
IN AL,PA
AND AL,11111101B
OUT PA,AL
OR AL,00000010B
OUT PA,AL
POP AX
RET

ORG 3200H
RUT_F10:
PUSH AX
MOV F10, 1
;EOI
MOV AL,EOI
OUT EOI,AL
POP AX
IRET
END
